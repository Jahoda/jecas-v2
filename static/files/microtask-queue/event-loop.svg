<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 800 600">
  <defs>
    <style>
      .title { font: bold 24px sans-serif; fill: #333; }
      .label { font: 16px sans-serif; fill: #333; }
      .small { font: 14px sans-serif; fill: #666; }
      .box { fill: #f0f0f0; stroke: #333; stroke-width: 2; }
      .highlight-micro { fill: #e3f2fd; stroke: #1976d2; stroke-width: 2; }
      .highlight-task { fill: #fff3e0; stroke: #f57c00; stroke-width: 2; }
      .arrow { fill: none; stroke: #333; stroke-width: 2; marker-end: url(#arrowhead); }
      .arrow-blue { fill: none; stroke: #1976d2; stroke-width: 2; marker-end: url(#arrowhead-blue); }
      .arrow-orange { fill: none; stroke: #f57c00; stroke-width: 2; marker-end: url(#arrowhead-orange); }
    </style>
    <marker id="arrowhead" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
      <polygon points="0 0, 10 3, 0 6" fill="#333" />
    </marker>
    <marker id="arrowhead-blue" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
      <polygon points="0 0, 10 3, 0 6" fill="#1976d2" />
    </marker>
    <marker id="arrowhead-orange" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
      <polygon points="0 0, 10 3, 0 6" fill="#f57c00" />
    </marker>
  </defs>

  <!-- Title -->
  <text x="400" y="35" text-anchor="middle" class="title">Event Loop s Microtask Queue</text>

  <!-- Call Stack -->
  <rect x="50" y="80" width="200" height="180" class="box" rx="5"/>
  <text x="150" y="105" text-anchor="middle" class="label">Call Stack</text>
  <rect x="70" y="120" width="160" height="35" fill="#4caf50" stroke="#2e7d32" stroke-width="2" rx="3"/>
  <text x="150" y="143" text-anchor="middle" class="small" fill="white">funkce()</text>

  <!-- Event Loop -->
  <ellipse cx="400" cy="170" rx="80" ry="50" fill="#ffeb3b" stroke="#f57f17" stroke-width="2"/>
  <text x="400" y="175" text-anchor="middle" class="label">Event</text>
  <text x="400" y="195" text-anchor="middle" class="label">Loop</text>

  <!-- Microtask Queue -->
  <rect x="550" y="80" width="200" height="180" class="highlight-micro" rx="5"/>
  <text x="650" y="105" text-anchor="middle" class="label">Microtask Queue</text>
  <text x="650" y="125" text-anchor="middle" class="small">(Vysoká priorita)</text>

  <rect x="570" y="145" width="160" height="30" fill="#1976d2" stroke="#0d47a1" stroke-width="1" rx="3"/>
  <text x="650" y="165" text-anchor="middle" class="small" fill="white">Promise.then()</text>

  <rect x="570" y="180" width="160" height="30" fill="#1976d2" stroke="#0d47a1" stroke-width="1" rx="3"/>
  <text x="650" y="200" text-anchor="middle" class="small" fill="white">queueMicrotask()</text>

  <rect x="570" y="215" width="160" height="30" fill="#1976d2" stroke="#0d47a1" stroke-width="1" rx="3"/>
  <text x="650" y="235" text-anchor="middle" class="small" fill="white">await ...</text>

  <!-- Task Queue -->
  <rect x="550" y="300" width="200" height="180" class="highlight-task" rx="5"/>
  <text x="650" y="325" text-anchor="middle" class="label">Task Queue</text>
  <text x="650" y="345" text-anchor="middle" class="small">(Macro Task)</text>

  <rect x="570" y="365" width="160" height="30" fill="#f57c00" stroke="#e65100" stroke-width="1" rx="3"/>
  <text x="650" y="385" text-anchor="middle" class="small" fill="white">setTimeout()</text>

  <rect x="570" y="400" width="160" height="30" fill="#f57c00" stroke="#e65100" stroke-width="1" rx="3"/>
  <text x="650" y="420" text-anchor="middle" class="small" fill="white">setInterval()</text>

  <rect x="570" y="435" width="160" height="30" fill="#f57c00" stroke="#e65100" stroke-width="1" rx="3"/>
  <text x="650" y="455" text-anchor="middle" class="small" fill="white">události</text>

  <!-- Arrows -->
  <!-- Call Stack to Event Loop -->
  <path d="M 250 170 L 320 170" class="arrow"/>
  <text x="285" y="165" text-anchor="middle" class="small">prázdný?</text>

  <!-- Event Loop to Microtask Queue -->
  <path d="M 450 140 L 540 120" class="arrow-blue"/>
  <text x="495" y="125" text-anchor="middle" class="small" fill="#1976d2">1. priorita</text>

  <!-- Event Loop to Task Queue -->
  <path d="M 450 200 L 540 350" class="arrow-orange"/>
  <text x="500" y="290" text-anchor="middle" class="small" fill="#f57c00">2. priorita</text>

  <!-- Back to Call Stack from Microtask -->
  <path d="M 550 150 Q 400 60 250 100" class="arrow-blue"/>

  <!-- Back to Call Stack from Task -->
  <path d="M 550 400 Q 150 500 150 260" class="arrow-orange"/>

  <!-- Execution order -->
  <rect x="50" y="510" width="700" height="70" fill="#f5f5f5" stroke="#999" stroke-width="1" rx="5"/>
  <text x="400" y="535" text-anchor="middle" class="label">Pořadí vykonávání:</text>
  <text x="400" y="560" text-anchor="middle" class="small">
    1. Synchronní kód → 2. Všechny microtasky → 3. Rendering → 4. Jeden task → opakovat
  </text>
</svg>